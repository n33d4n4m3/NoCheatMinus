#   This program is free software: you can redistribute it and/or modify
#   it under the terms of the GNU General Public License as published by
#   the Free Software Foundation, either version 3 of the License, or
#   (at your option) any later version.
#
#   This program is distributed in the hope that it will be useful,
#   but WITHOUT ANY WARRANTY; without even the implied warranty of
#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#   GNU General Public License for more details.
#
#   You should have received a copy of the GNU General Public License
#   along with this program.  If not, see <http://www.gnu.org/licenses/>.
#
#
# ...
# Description:  This command allows the operator to start the setup tour.
# Usage:        /trigger ncmTour
# Author:       n33d4n4m3
# ...

execute as @a if score @s ncmOperator matches 2 run scoreboard players enable @a ncmTour
execute as @a unless score @s ncmOperator matches 2 run trigger ncmTour set 0

# Notify
execute unless score DataHolder ncmFinishedTour matches 1 as @a if score @s ncmLeaveGame matches 1 unless score @s ncmOperator matches 2 run tellraw @s [{"text":""},{"text":"NCM","color":"red"},{"text":": NoCheatMinus ","color":"gray"},{"text":"Build ","color":"yellow"},{"score":{"name":"DataHolder","objective":"ncmBuildNumber"},"color":"yellow"},{"text":" for Minecraft 1.21.3-1.21.4 has been successfully installed but is currently inactive. Operators, please run","color":"gray"},{"text":" /scoreboard players set @s ncmOperator 1 ","color":"yellow","click_event":{"action":"run_command","command":"/scoreboard players set @s ncmOperator 1"},"hover_event":{"action":"show_text","value":[{"text":"/scoreboard players set @s ncmOperator 1"}]}},{"text":"to initiate the next steps.","color":"gray"}]
execute unless score DataHolder ncmFinishedTour matches 1 as @a if score @s ncmLeaveGame matches 1 if score @s ncmOperator matches 2 run tellraw @s [{"text":""},{"text":"NCM","color":"red"},{"text":": NoCheatMinus ","color":"gray"},{"text":"Build ","color":"yellow"},{"score":{"name":"DataHolder","objective":"ncmBuildNumber"},"color":"yellow"},{"text":" for Minecraft 1.21.3-1.21.4 has been successfully installed but will remain inactive until you complete the setup tour. If you have time, you can start it anytime with","color":"gray"},{"text":" /trigger ncmTour","color":"yellow","click_event":{"action":"run_command","command":"/trigger ncmTour"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour"}]}},{"text":". It only takes a few minutes.","color":"gray"}]


execute as @a if score @s ncmTour matches 1 run tellraw @s [{"text":""},{"text":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"text":"\n"},{"text":"NOCHEATMINUS TOUR","bold":true,"color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Welcome to the Introduction Tour for NoCheatMinus. You can pause this tour at any time and restart it later with","color":"dark_aqua"},{"text":"\n"},{"text":" /trigger ncmTour ","color":"yellow","click_event":{"action":"run_command","command":"/trigger ncmTour"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour"}]}},{"text":"\n"},{"text":"\n"},{"text":"Next > (click)","color":"green","click_event":{"action":"run_command","command":"/trigger ncmTour set 2"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour set 2"}]}},{"text":"\n"}]
execute as @a if score @s ncmTour matches 2 run tellraw @s [{"text":""},{"text":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"text":"\n"},{"text":"NOCHEATMINUS TOUR","bold":true,"color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"NoCheatMinus is an AntiCheat datapack that analyzes player behavior in the background and compares it to expected values. Players are automatically subjected to various checks across multiple categories.","color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Next > (click)","color":"green","click_event":{"action":"run_command","command":"/trigger ncmTour set 3"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour set 3"}]}},{"text":"\n"}]
execute as @a if score @s ncmTour matches 3 run tellraw @s [{"text":""},{"text":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"text":"\n"},{"text":"NOCHEATMINUS TOUR","bold":true,"color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"If a check fails, it indicates suspicious behavior. By default, all operators are notified when a check is not passed. However, this does not necessarily mean that a player is cheating. (See: Documentation → False Positives)","color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Next > (click)","color":"green","click_event":{"action":"run_command","command":"/trigger ncmTour set 4"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour set 4"}]}},{"text":"\n"}]
execute as @a if score @s ncmTour matches 4 run tellraw @s [{"text":""},{"text":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"text":"\n"},{"text":"NOCHEATMINUS TOUR","bold":true,"color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Every player on the server has a hidden reputation score, which is not visible to them but can be viewed by operators. The reputation score reflects how often and how severely certain checks have been failed. The lower the score, the more likely it is that the player is cheating.","color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Next > (click)","color":"green","click_event":{"action":"run_command","command":"/trigger ncmTour set 5"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour set 5"}]}},{"text":"\n"}]
execute as @a if score @s ncmTour matches 5 run tellraw @s [{"text":""},{"text":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"text":"\n"},{"text":"NOCHEATMINUS TOUR","bold":true,"color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"You can view a player’s reputation score and some statistics with the following command: ","color":"dark_aqua"},{"text":"/trigger ncmStats","color":"yellow"},{"text":". Alternatively, you can use ","color":"dark_aqua"},{"text":"/trigger ncmReport","color":"yellow"},{"text":" to get a summary of whether there are any players online that you should keep an eye on.","color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Next > (click)","color":"green","click_event":{"action":"run_command","command":"/trigger ncmTour set 15"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour set 15"}]}},{"text":"\n"}]
execute as @a if score @s ncmTour matches 15 run tellraw @s [{"text":""},{"text":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"text":"\n"},{"text":"NOCHEATMINUS TOUR","bold":true,"color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"The ","color":"dark_aqua"},{"text":"Replay System","color":"yellow"},{"text":" automatically records movements for 5 seconds before and 5 seconds after a suspicious action. These clips are compiled into a 10-second video for review. Operators can analyze these clips and determine if the action was indeed suspicious. You can use ","color":"dark_aqua"},{"text":"/trigger ncmReplay","color":"yellow","click_event":{"action":"run_command","command":"/trigger ncmReplay"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmReplay"}]}},{"text":" to select a replay clip you want to watch.","color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Next > (click)","color":"green","click_event":{"action":"run_command","command":"/trigger ncmTour set 6"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour set 6"}]}},{"text":"\n"}]
execute as @a if score @s ncmTour matches 6 run tellraw @s [{"text":""},{"text":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"text":"\n"},{"text":"NOCHEATMINUS TOUR","bold":true,"color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"NoCheatMinus is fundamentally designed as a silent AntiCheat. This means it never reveals itself to the player, quietly records all violations, and adjusts the player’s reputation accordingly. This mode is known as the ","color":"dark_aqua"},{"text":"Silent Mode","color":"yellow"},{"text":".","color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Next > (click)","color":"green","click_event":{"action":"run_command","command":"/trigger ncmTour set 7"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour set 7"}]}},{"text":"\n"}]
execute as @a if score @s ncmTour matches 7 run tellraw @s [{"text":""},{"text":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"text":"\n"},{"text":"NOCHEATMINUS TOUR","bold":true,"color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"However, you also have the option to select","color":"dark_aqua"},{"text":" Block Mode","color":"red"},{"text":". This mode functions similarly to ","color":"dark_aqua"},{"text":"Silent Mode ","color":"yellow"},{"text":"but goes a step further: it not only records violations but also actively prevents them. Suspicious movements and actions are either reversed or blocked in real time.","color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Next > (click)","color":"green","click_event":{"action":"run_command","command":"/trigger ncmTour set 8"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour set 8"}]}},{"text":"\n"}]
execute as @a if score @s ncmTour matches 8 run tellraw @s [{"text":""},{"text":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"text":"\n"},{"text":"NOCHEATMINUS TOUR","bold":true,"color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Advantage of Block Mode: ","color":"green"},{"text":"\n"},{"text":"Cheating is actively stopped without requiring operator intervention.","color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Disadvantages of Block Mode: ","color":"red"},{"text":"\n"},{"text":"- Players immediately receive feedback on whether their cheats are working, allowing them to adjust their clients to bypass NoCheatMinus.","color":"dark_aqua"},{"text":"\n"},{"text":"- Players with high network latency are automatically excluded from certain penalty actions in Block Mode to maintain playability.","color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Next > (click)","color":"green","click_event":{"action":"run_command","command":"/trigger ncmTour set 9"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour set 9"}]}},{"text":"\n"}]
execute as @a if score @s ncmTour matches 9 run tellraw @s [{"text":""},{"text":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"text":"\n"},{"text":"NOCHEATMINUS TOUR","bold":true,"color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Please choose a mode (click to select):","color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"-> Silent Mode <-","color":"yellow","click_event":{"action":"run_command","command":"/trigger ncmTour set 10"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour set 10"}]}},{"text":"\n"},{"text":"\n"},{"text":"-> Block Mode <-","color":"red","click_event":{"action":"run_command","command":"/trigger ncmTour set 11"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour set 11"}]}},{"text":"\n"},{"text":"\n"},{"text":"\n"}]
execute as @a if score @s ncmTour matches 10 run tellraw @s [{"text":""},{"text":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"text":"\n"},{"text":"NOCHEATMINUS TOUR","bold":true,"color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"You have selected","color":"dark_aqua"},{"text":" Silent Mode","color":"yellow"},{"text":". Now, let’s discuss Input Levels. By default, all operators receive notifications when a check fails. This is known as ","color":"dark_aqua"},{"text":"Input Level 2 ","color":"yellow"},{"text":".","color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Next >","color":"green","click_event":{"action":"run_command","command":"/trigger ncmTour set 12"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour set 12"}]}},{"text":"\n"}]
execute as @a if score @s ncmTour matches 10 run scoreboard players set DataHolder ncmBlockMode 0
execute as @a if score @s ncmTour matches 11 run tellraw @s [{"text":""},{"text":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"text":"\n"},{"text":"NOCHEATMINUS TOUR","bold":true,"color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"You have selected","color":"dark_aqua"},{"text":" Block Mode","color":"red"},{"text":". Now, let’s discuss Input Levels. By default, all operators receive notifications when a check fails. This is known as ","color":"dark_aqua"},{"text":"Input Level 2 ","color":"yellow"},{"text":".","color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Next >","color":"green","click_event":{"action":"run_command","command":"/trigger ncmTour set 12"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour set 12"}]}},{"text":"\n"}]
execute as @a if score @s ncmTour matches 11 run scoreboard players set DataHolder ncmBlockMode 1
execute as @a if score @s ncmTour matches 12 run tellraw @s [{"text":""},{"text":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"text":"\n"},{"text":"NOCHEATMINUS TOUR","bold":true,"color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Input Level 1 means:","color":"dark_aqua"},{"text":"\n"},{"text":"You only receive notifications for players you’re actively monitoring. Use ","color":"dark_aqua"},{"text":"/scoreboard players set PLAYERNAME ncmVerbose 1","color":"yellow"},{"text":" to mark players for detailed monitoring.","color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Next >","color":"green","click_event":{"action":"run_command","command":"/trigger ncmTour set 13"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour set 13"}]}},{"text":"\n"}]
execute as @a if score @s ncmTour matches 13 run tellraw @s [{"text":""},{"text":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"text":"\n"},{"text":"NOCHEATMINUS TOUR","bold":true,"color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Input Level 2 means:","color":"dark_aqua"},{"text":"\n"},{"text":"You receive notifications for all players on the server. This is the default setting.","color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Next >","color":"green","click_event":{"action":"run_command","command":"/trigger ncmTour set 14"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour set 14"}]}},{"text":"\n"}]
execute as @a if score @s ncmTour matches 14 run tellraw @s [{"text":""},{"text":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"text":"\n"},{"text":"NOCHEATMINUS TOUR","bold":true,"color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Input Level 0 means:","color":"dark_aqua"},{"text":"\n"},{"text":"You receive no notifications for any players.","color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"You can change the input level anytime with ","color":"dark_aqua"},{"text":"/trigger ncmInput (0/1/2)","color":"yellow"},{"text":".","color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"Next >","color":"green","click_event":{"action":"run_command","command":"/trigger ncmTour set 100"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour set 100"}]}},{"text":"\n"}]
# Tour finish!


execute as @a if score @s ncmTour matches 100 run tellraw @s [{"text":""},{"text":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"text":"\n"},{"text":"END OF THE TOUR","bold":true,"color":"yellow"},{"text":"\n"},{"text":"\n"},{"text":"That’s the end of the NoCheatMinus tour. You can restart this tour anytime with ","color":"dark_aqua"},{"text":"/trigger ncmTour","color":"yellow","click_event":{"action":"run_command","command":"/trigger ncmTour"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmTour"}]}},{"text":". Use ","color":"dark_aqua"},{"text":"/trigger ncmHelp","color":"yellow","click_event":{"action":"run_command","command":"/trigger ncmHelp"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmHelp"}]}},{"text":" to get an overview of available commands and options.","color":"dark_aqua"},{"text":"\n"},{"text":"\n"},{"text":"NoCheatMinus is now fully activated with all checks running and monitoring player behavior.","color":"green"},{"text":"\n"},{"text":"Use ","color":"dark_aqua"},{"text":"/trigger ncmChecks","color":"yellow","click_event":{"action":"run_command","command":"/trigger ncmChecks"},"hover_event":{"action":"show_text","value":[{"text":"/trigger ncmChecks"}]}},{"text":" to enable or disable specific checks.","color":"dark_aqua"},{"text":"\n"}]
execute as @a unless score DataHolder ncmFinishedTour matches 1 if score @s ncmTour matches 100 run scoreboard players set DataHolder ncmcm_toggle_BIMB 1
execute as @a unless score DataHolder ncmFinishedTour matches 1 if score @s ncmTour matches 100 run scoreboard players set DataHolder ncmcm_toggle_BPAP 1
execute as @a unless score DataHolder ncmFinishedTour matches 1 if score @s ncmTour matches 100 run scoreboard players set DataHolder ncmcm_toggle_COMBL 1
execute as @a unless score DataHolder ncmFinishedTour matches 1 if score @s ncmTour matches 100 run scoreboard players set DataHolder ncmcm_toggle_COMMUN 1
execute as @a unless score DataHolder ncmFinishedTour matches 1 if score @s ncmTour matches 100 run scoreboard players set DataHolder ncmcm_toggle_FCR 1
execute as @a unless score DataHolder ncmFinishedTour matches 1 if score @s ncmTour matches 100 run scoreboard players set DataHolder ncmcm_toggle_FRC 1
execute as @a unless score DataHolder ncmFinishedTour matches 1 if score @s ncmTour matches 100 run scoreboard players set DataHolder ncmcm_toggle_INVAP 2
execute as @a unless score DataHolder ncmFinishedTour matches 1 if score @s ncmTour matches 100 run scoreboard players set DataHolder ncmcm_toggle_MVMSF 1
execute as @a unless score DataHolder ncmFinishedTour matches 1 if score @s ncmTour matches 100 run scoreboard players set DataHolder ncmcm_toggle_NETAP 1
execute as @a unless score DataHolder ncmFinishedTour matches 1 if score @s ncmTour matches 100 run scoreboard players set DataHolder ncmcm_toggle_NETUP 1
execute as @a unless score DataHolder ncmFinishedTour matches 1 if score @s ncmTour matches 100 run scoreboard players set DataHolder ncmcm_toggle_MVMTS 1
execute as @a unless score DataHolder ncmFinishedTour matches 1 if score @s ncmTour matches 100 run scoreboard players set DataHolder ncmcm_toggle_MVMNF 1
execute as @a unless score DataHolder ncmFinishedTour matches 1 if score @s ncmTour matches 100 run scoreboard players set DataHolder ncmcm_toggle_FWT 1
execute as @a unless score DataHolder ncmFinishedTour matches 1 if score @s ncmTour matches 100 run scoreboard players set DataHolder ncmcm_toggle_FCV 1
execute as @a unless score DataHolder ncmFinishedTour matches 1 if score @s ncmTour matches 100 run scoreboard players set DataHolder ncmcm_toggle_IIB 1
execute as @a unless score DataHolder ncmFinishedTour matches 1 if score @s ncmTour matches 100 run scoreboard players set DataHolder ncmcm_toggle_FD 1
execute as @a unless score DataHolder ncmFinishedTour matches 1 if score @s ncmTour matches 100 run scoreboard players set DataHolder ncmcm_toggle_COMEX 1
execute as @a if score @s ncmTour matches 100 run function ncm:checks/checkmanager
execute as @a if score @s ncmTour matches 100 run scoreboard players set DataHolder ncmFinishedTour 1
execute as @a if score @s ncmTour matches 100 run scoreboard players set @s ncmTour 0


execute unless score DataHolder ncmFinishedTour matches 1 run scoreboard players set DataHolder ncmcm_toggle_BIMB 2
execute unless score DataHolder ncmFinishedTour matches 1 run scoreboard players set DataHolder ncmcm_toggle_BPAP 2
execute unless score DataHolder ncmFinishedTour matches 1 run scoreboard players set DataHolder ncmcm_toggle_COMBL 2
execute unless score DataHolder ncmFinishedTour matches 1 run scoreboard players set DataHolder ncmcm_toggle_COMMUN 2
execute unless score DataHolder ncmFinishedTour matches 1 run scoreboard players set DataHolder ncmcm_toggle_FCR 2
execute unless score DataHolder ncmFinishedTour matches 1 run scoreboard players set DataHolder ncmcm_toggle_FRC 2
execute unless score DataHolder ncmFinishedTour matches 1 run scoreboard players set DataHolder ncmcm_toggle_INVAP 2
execute unless score DataHolder ncmFinishedTour matches 1 run scoreboard players set DataHolder ncmcm_toggle_MVMSF 2
execute unless score DataHolder ncmFinishedTour matches 1 run scoreboard players set DataHolder ncmcm_toggle_NETAP 2
execute unless score DataHolder ncmFinishedTour matches 1 run scoreboard players set DataHolder ncmcm_toggle_NETUP 2
execute unless score DataHolder ncmFinishedTour matches 1 run scoreboard players set DataHolder ncmcm_toggle_MVMTS 2
execute unless score DataHolder ncmFinishedTour matches 1 run scoreboard players set DataHolder ncmcm_toggle_MVMNF 2
execute unless score DataHolder ncmFinishedTour matches 1 run scoreboard players set DataHolder ncmcm_toggle_FWT 2
execute unless score DataHolder ncmFinishedTour matches 1 run scoreboard players set DataHolder ncmcm_toggle_FCV 2
execute unless score DataHolder ncmFinishedTour matches 1 run scoreboard players set DataHolder ncmcm_toggle_IIB 2
execute unless score DataHolder ncmFinishedTour matches 1 run scoreboard players set DataHolder ncmcm_toggle_FD 2
execute unless score DataHolder ncmFinishedTour matches 1 run scoreboard players set DataHolder ncmcm_toggle_COMEX 2
execute unless score DataHolder ncmFinishedTour matches 1 run function ncm:checks/checkmanager
execute as @a if score @s ncmTour matches 1.. run scoreboard players set @s ncmTour 0